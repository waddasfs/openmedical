# 实时聊天收费方案设计

## 收费模式概述

实时聊天模式采用**基础费用 + 按时间计费**的混合收费模式，确保服务的灵活性和公平性。

## 详细收费方案

### 基础费用
- **金额**: 0.02 ETH
- **用途**: 覆盖系统运营成本、医生分配费用
- **收取时机**: 用户发起咨询时立即收取
- **是否退还**: 如因系统问题无法分配医生，可申请退还

### 时间计费
- **计费单位**: 按分钟计费
- **计费标准**: 0.005 ETH/分钟
- **计费开始**: 医生开始回复消息时开始计时
- **计费结束**: 用户主动结束咨询或医生结束咨询时停止
- **最小计费时间**: 1分钟（不足1分钟按1分钟计算）

### 收费示例

#### 示例1: 短时间咨询
- 基础费用: 0.02 ETH
- 咨询时长: 5分钟
- 时间费用: 5 × 0.005 = 0.025 ETH
- **总费用: 0.045 ETH**

#### 示例2: 中等时长咨询
- 基础费用: 0.02 ETH
- 咨询时长: 30分钟
- 时间费用: 30 × 0.005 = 0.15 ETH
- **总费用: 0.17 ETH**

#### 示例3: 长时间咨询
- 基础费用: 0.02 ETH
- 咨询时长: 2小时 (120分钟)
- 时间费用: 120 × 0.005 = 0.6 ETH
- **总费用: 0.62 ETH**

## 收费策略优化

### 1. 阶梯式收费
考虑实施阶梯式收费，鼓励用户进行更长时间的咨询：

| 咨询时长 | 基础费用 | 每分钟费用 | 说明 |
|----------|----------|------------|------|
| 0-30分钟 | 0.02 ETH | 0.005 ETH | 标准费率 |
| 31-60分钟 | 0.02 ETH | 0.004 ETH | 9折优惠 |
| 61-120分钟 | 0.02 ETH | 0.003 ETH | 8折优惠 |
| 120分钟以上 | 0.02 ETH | 0.002 ETH | 7折优惠 |

### 2. 会员制度
为长期用户提供会员优惠：

| 会员等级 | 基础费用折扣 | 时间费用折扣 | 月费 |
|----------|--------------|--------------|------|
| 普通用户 | 无 | 无 | 免费 |
| 银牌会员 | 9折 | 9折 | 0.1 ETH |
| 金牌会员 | 8折 | 8折 | 0.2 ETH |
| 钻石会员 | 7折 | 7折 | 0.5 ETH |

### 3. 时段优惠
不同时段的差异化收费：

| 时段 | 基础费用 | 时间费用 | 说明 |
|------|----------|----------|------|
| 工作日 9:00-18:00 | 0.02 ETH | 0.005 ETH | 标准费率 |
| 工作日 18:00-22:00 | 0.02 ETH | 0.006 ETH | 加班费 |
| 周末全天 | 0.02 ETH | 0.004 ETH | 周末优惠 |
| 深夜 22:00-9:00 | 0.02 ETH | 0.008 ETH | 夜间加费 |

## 支付流程

### 1. 预付费模式（推荐）
- 用户先支付预估费用
- 系统按实际使用时间计费
- 咨询结束后退还多余费用
- 如费用不足，提醒用户续费

### 2. 后付费模式
- 用户先支付基础费用
- 咨询过程中实时扣费
- 余额不足时暂停服务
- 咨询结束后结算总费用

## 技术实现

### 计费逻辑
```python
def calculate_realtime_fee(base_fee, duration_minutes, user_level="normal"):
    """计算实时聊天费用"""
    # 基础费用
    total_fee = base_fee
    
    # 根据用户等级和时间长度计算折扣
    discount = get_user_discount(user_level, duration_minutes)
    
    # 时间费用
    time_fee = duration_minutes * 0.005 * discount
    total_fee += time_fee
    
    return total_fee
```

### 实时计费监控
- 每5分钟检查一次使用时间
- 实时更新费用显示
- 余额不足时发送提醒
- 自动暂停服务机制

## 费用透明化

### 1. 费用预估
- 咨询开始前显示预估费用
- 实时显示当前费用
- 提供费用计算器

### 2. 费用明细
- 基础费用明细
- 时间费用明细
- 折扣优惠明细
- 总费用汇总

### 3. 费用历史
- 查看历史咨询费用
- 费用趋势分析
- 月度费用统计

## 风险控制

### 1. 费用上限
- 设置单次咨询费用上限
- 设置日费用上限
- 设置月费用上限

### 2. 异常监控
- 异常长时间咨询监控
- 异常高频咨询监控
- 自动预警机制

### 3. 争议处理
- 费用争议申诉渠道
- 人工审核机制
- 费用调整流程

## 市场竞争力

### 1. 价格对比
与其他在线医疗平台对比：
- 传统平台: 通常按次收费，50-200元/次
- 我们的优势: 按需付费，灵活计费

### 2. 价值主张
- 透明计费，无隐藏费用
- 灵活付费，按需使用
- 优质服务，专业医生
- 便捷支付，以太坊支付

## 实施建议

### 第一阶段：基础计费
- 实施基础费用 + 按分钟计费
- 简单的费用显示
- 基本的支付流程

### 第二阶段：优化计费
- 实施阶梯式收费
- 添加会员制度
- 完善费用透明化

### 第三阶段：智能计费
- 基于AI的智能定价
- 动态费用调整
- 个性化优惠策略

这个收费方案既保证了服务的灵活性，又确保了平台的盈利能力，同时为用户提供了透明的计费体验。

